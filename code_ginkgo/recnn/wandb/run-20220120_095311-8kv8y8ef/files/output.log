search_hyperparams.py sample_name= ../data/preprocessed_trees/
--------------------------------------------------------------------------------
Model dir= experiments/ginkgo/ginkgo_kt_lr_0.002_decay_0.9_batch_32_epochs_30_hidden_20_Njets_2000_features_4/run_0
CUDA_VISIBLE_DEVICES=2 /Users/laurengreenspan/miniconda3/bin/python train.py --model_dir=experiments/ginkgo/ginkgo_kt_lr_0.002_decay_0.9_batch_32_epochs_30_hidden_20_Njets_2000_features_4/run_0 --data_dir=../data/preprocessed_trees/ --jet_algorithm=kt --architecture=NiNRecNNReLU
sample_name=ginkgo
--------------------------------------------------------------------------------
sample_filename=ginkgo_kt_2000jets
------------------------------------------------------------
Loading the datasets...
- done loading the datasets
------------------------------------------------------------
Total parameters of the model= 12701
Total weights of the model= 12701
Model= PredictFromParticleEmbeddingNiNReLU(
  (fc_u): Linear(in_features=4, out_features=20, bias=True)
  (fc_h): Linear(in_features=60, out_features=20, bias=True)
  (fc_u_inner1): Linear(in_features=4, out_features=20, bias=True)
  (fc_u_outer1): Linear(in_features=4, out_features=20, bias=True)
  (fc_u_inner): Linear(in_features=4, out_features=20, bias=True)
  (fc_u_outer): Linear(in_features=4, out_features=20, bias=True)
  (fc_N0): Linear(in_features=20, out_features=20, bias=True)
  (fc_N1): Linear(in_features=20, out_features=20, bias=True)
  (fc_N2): Linear(in_features=20, out_features=20, bias=True)
  (fc_N3): Linear(in_features=20, out_features=20, bias=True)
  (fc_N4): Linear(in_features=20, out_features=20, bias=True)
  (fc_N5): Linear(in_features=20, out_features=20, bias=True)
  (fc_N6): Linear(in_features=20, out_features=20, bias=True)
  (fc_N7): Linear(in_features=20, out_features=20, bias=True)
  (fc_N8): Linear(in_features=20, out_features=20, bias=True)
  (fc_N9): Linear(in_features=20, out_features=20, bias=True)
  (transform): GRNNTransformSimpleNiNReLU(
    (fc_u): Linear(in_features=4, out_features=20, bias=True)
    (fc_h): Linear(in_features=60, out_features=20, bias=True)
    (fc_u_inner1): Linear(in_features=4, out_features=20, bias=True)
    (fc_u_outer1): Linear(in_features=4, out_features=20, bias=True)
    (fc_u_inner): Linear(in_features=4, out_features=20, bias=True)
    (fc_u_outer): Linear(in_features=4, out_features=20, bias=True)
    (fc_N0): Linear(in_features=20, out_features=20, bias=True)
    (fc_N1): Linear(in_features=20, out_features=20, bias=True)
    (fc_N2): Linear(in_features=20, out_features=20, bias=True)
    (fc_N3): Linear(in_features=20, out_features=20, bias=True)
    (fc_N4): Linear(in_features=20, out_features=20, bias=True)
    (fc_N5): Linear(in_features=20, out_features=20, bias=True)
    (fc_N6): Linear(in_features=20, out_features=20, bias=True)
    (fc_N7): Linear(in_features=20, out_features=20, bias=True)
    (fc_N8): Linear(in_features=20, out_features=20, bias=True)
    (fc_N9): Linear(in_features=20, out_features=20, bias=True)
  )
  (fc1): Linear(in_features=20, out_features=20, bias=True)
  (fc2): Linear(in_features=20, out_features=20, bias=True)
  (fc3): Linear(in_features=20, out_features=1, bias=True)
)
------------------------------------------------------------
Building optimizer...
Starting training for 30 epoch(s)
Epoch 1/30
[34m[1mwandb[39m[22m: Currently logged in as: [33mlbg251[39m (use `wandb login --relogin` to force relogin)
[34m[1mwandb[39m[22m: Tracking run with wandb version 0.12.9
[34m[1mwandb[39m[22m: Syncing run [33mwise-bird-2
[34m[1mwandb[39m[22m:  View project at [34m[4mhttps://wandb.ai/lbg251/Ginkgo%20Tree
[34m[1mwandb[39m[22m:  View run at [34m[4mhttps://wandb.ai/lbg251/Ginkgo%20Tree/runs/jm7p6w77
[34m[1mwandb[39m[22m: Run data is saved locally in /Users/laurengreenspan/GitDLs/TreeNiNNew/code_ginkgo/recnn/wandb/run-20220120_095321-jm7p6w77
[34m[1mwandb[39m[22m: Run `wandb offline` to turn off syncing.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:14<00:00,  2.47it/s, loss=0.713]
- Train metrics: accuracy: 0.5148 ; loss: 0.7087
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5078 ; loss: 0.6934
- Found new best bg rejection = 4.266666666666667
Epoch 2/30
  0%|                                                    | 0/37 [00:00<?, ?it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:22<00:00,  1.66it/s, loss=0.692]
- Train metrics: accuracy: 0.5378 ; loss: 0.6873
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5208 ; loss: 0.6938
- Found new best bg rejection = 4.363636363636364
Epoch 3/30
  0%|                                                    | 0/37 [00:00<?, ?it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:10<00:00,  3.53it/s, loss=0.692]
- Train metrics: accuracy: 0.5510 ; loss: 0.6865
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5443 ; loss: 0.6906
Checkpoint Directory exists!
Epoch 4/30
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:12<00:00,  2.91it/s, loss=0.692]
- Train metrics: accuracy: 0.5296 ; loss: 0.6860
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5521 ; loss: 0.6884
Checkpoint Directory exists!
Epoch 5/30
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:13<00:00,  2.65it/s, loss=0.692]
- Train metrics: accuracy: 0.5230 ; loss: 0.6860
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5495 ; loss: 0.6874
Checkpoint Directory exists!
Epoch 6/30
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:13<00:00,  2.78it/s, loss=0.692]
- Train metrics: accuracy: 0.5345 ; loss: 0.6866
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5365 ; loss: 0.6873
Checkpoint Directory exists!
- Found new best bg rejection = 4.465116279069767
Epoch 7/30

100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:11<00:00,  3.09it/s, loss=0.691]
- Train metrics: accuracy: 0.5428 ; loss: 0.6865
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
- Eval metrics : accuracy: 0.5260 ; loss: 0.6869
Checkpoint Directory exists!
Epoch 8/30


100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:11<00:00,  3.18it/s, loss=0.689]
- Train metrics: accuracy: 0.5543 ; loss: 0.6860
train.py:219: RuntimeWarning: divide by zero encountered in true_divide
  inv_fpr = interp(base_tpr, tpr, 1. / fpr)[125]
